var jwt = require('jsonwebtoken');
const express=require('express');
const router=express.Router();
const Company=require("./model/Company");
const User=require("./model/Users")
const mongoose=require('mongoose'); 
const str=require('string');

router.delete('/stuList/:id', (req, res) => {

    var id = req.params.id;
    id=mongoose.Types.ObjectId(id);
    
    User.findByIdAndDelete(id)
        .then(resolve => {
            console.log("Delete Succesfully: ", resolve);

            res.send("Student Deleted");

        });

})

router.get('/stuList',(req,res)=>{
    var token=req.headers['authorization'];
    try {
        var decoded = jwt.verify(token, 'shhhh');
        var query={
            role:'Student'
        }
        User.find(query,(error,response)=>{
           if(error){
               res.status(500);
               res.send(error);
               return
           }
        
       res.send(response);
        })
       
      } 
    catch(err) {
        res.status(401).send(err);
      }
    
    
})

router.get('/compList',(req,res)=>{
    var token=req.headers['authorization'];
    try {
        var decoded = jwt.verify(token, 'shhhh');
        Company.find((error,response)=>{
           if(error){
               res.status(500);
               res.send(error);
               return
           }
        
       res.send(response);
        })
       
      } 
    catch(err) {
        res.status(401).send(err);
      }
    
    
})
router.delete('/compList/:id', (req, res) => {

    var id = req.params.id;
    id=mongoose.Types.ObjectId(id);
    
    Company.findByIdAndDelete(id)
        .then(resolve => {
            console.log("Delete Succesfully: ", resolve);

            res.send("Company Deleted");

        });

})

module.exports=router;