const express=require("express");
const router=express.Router();
var jwt = require('jsonwebtoken');
const User=require("./model/Users");
const Company=require("./model/Company");
const studentModule=require('./student');
const compModule=require('./company');
const adminModule=require('./admin');

router.use('/admin',adminModule);
router.use('/student',studentModule);
router.use('/comp',compModule);
router.post("/",(req,res)=>{
    var data=req.body;
 

    User.find(data,(error,response)=>{
        if(error){
            res.status(500);
            res.send(error);
            return;
        }
        // console.log(response);
        if(response.length){
            var token=jwt.sign({userid:response[0]._id},"shhhh");
            res.send(token);
        }
        else{
            res.send("user not found")
        }
        })
    });
    router.post("/company",(req,res)=>{
        var data=req.body;
        console.log(data);
    
        Company.find(data,(error,response)=>{
            if(error){
                res.status(500);
                res.send(error);
                return;
            }
            // console.log(response);
            if(response.length){
                var token=jwt.sign({compid:response[0]._id},"shhhh");
                res.send(token);
            }
            else{
                res.send("user not found")
            }
            })
        });
      
        module.exports=router;